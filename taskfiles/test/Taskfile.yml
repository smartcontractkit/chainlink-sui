version: "3"

tasks:
  default:
    desc: "Run unit and integration tests"
    cmds:
      - task: unit
      - task: integration

  unit:
    desc: "Run unit tests"
    cmds:
      - for:
          matrix:
            MODULE: [".", "./relayer"]
        cmd: cd {{ .ITEM.MODULE }} && go test {{.CLI_ARGS}} -tags=unit ./...

  integration:
    desc: "Run integration tests"
    cmds:
      - for:
          matrix:
            MODULE: [".", "./relayer"]
        cmd: cd {{ .ITEM.MODULE }} && go test {{.CLI_ARGS}} -tags=integration ./...

  integration-testnet:
    desc: "Run integration tests in testnet"
    cmds:
      - for:
          matrix:
            MODULE: [".", "./relayer"]
        cmd: cd {{ .ITEM.MODULE }} && go test {{.CLI_ARGS}} -tags="integration testnet" ./...
